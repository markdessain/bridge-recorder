<html>
	<head>
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

		<!-- Latest compiled and minified JavaScript -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

  		<script type="text/javascript" src="https://cdn.firebase.com/v0/firebase.js"></script>
		

		<style>



  // hover state
  .card:hover {
    bottom: 1em;
    .transition(~"bottom .15s");
  }

  
  // Suit colors
  // ------------------
  
  .card.diams {
    color: #00f;
  }

  .card.hearts {
    color: #f00;
  }

  .card.spades {
    color: #000;
  }

  .card.clubs {
    color: #090;
  }

  
  // Top left - rank and suit
  // ------------------

  .card .rank,
  .card .suit {
    display: block;
    line-height: 1;
    text-align: left;
  }

  .card .rank {
  }

  .card .suit {
    line-height: .7;
  }
  
  .card .rank:after {
    position: absolute;
    top: .25em;
    left: .25em;
    background: #fff;
  }

  
  // Middle - big suit
  // ------------------
  
  .card .suit:after {
    font-family: Georgia, serif;
    position: absolute;
    font-size: 3em;
    right: .1em;
    bottom: .25em;
    word-spacing: normal;
    letter-spacing: normal;
    line-height: 1;
  }
  
  .card .suit:after {
    font-family: Arial, sans-serif;
    line-height: .9;
    bottom: .35em;
  }

  .card.diams .suit:after {
    content: "\2666";
    right: .4em;
  }

  .card.hearts .suit:after {
    content: "\2665";
    right: .35em;
  }

  .card.spades .suit:after {
    content: "\2660";
    right: .35em;
  }

  .card.clubs .suit:after {
    content: "\2663";
    right: .3em;
  }

  .card.nt .suit:after {
    content: "";
    right: .3em;
  }

  .btn-default.active {
	background-color: #428bca;
	border-color: #428bca;
	color: white;
  }
		</style>
		<script>

			$( document ).ready(function() {


				var club_map = {};
				club_map["C"] = "clubs";
				club_map["D"] = "diams";
				club_map["H"] = "hearts";
				club_map["S"] = "spades";
				club_map["NT"] = "nt";

				var table_position = null;

				$(".table-position").click(function() {
					if(table_position != null) {
						table_position.removeClass("active");
					}
					table_position = $(this);
					table_position.addClass("active");
				});

				var selected_bid_level = null;
				var selected_bid_suit = null;
				var selected_bid_alternative = null;

				$(".bit-alternative").click(function() {
					if(selected_bid_alternative != null) {
						selected_bid_alternative.removeClass("active");
					}
					selected_bid_alternative = $(this);
					selected_bid_alternative.addClass("active");
					addBid();
				});

				$(".bid-level").click(function() {
					if(selected_bid_level != null) {
						selected_bid_level.removeClass("active");
					}
					selected_bid_level = $(this);
					selected_bid_level.addClass("active");
					addBid();
				});

				$(".bid-suit").click(function() {
					if(selected_bid_suit != null) {
						selected_bid_suit.removeClass("active");
					}
					selected_bid_suit = $(this);
					selected_bid_suit.addClass("active");
					addBid();
				});
				

				function addBid() {
					if(selected_bid_level != null && selected_bid_suit != null) {

						suit = '';
						if(club_map[selected_bid_suit.text().trim()] == 'nt') {
							suit = 'NT';
						}

						new_bid = "<span class='card " + club_map[selected_bid_suit.text().trim()] +"  lead'><span class='rank'>" + selected_bid_level.text() + "</span> <span class='suit'>" + suit + "</span></span>";

						$("#bids").append("<li bid='" + selected_bid_level.text() + selected_bid_suit.text().trim() + "' >" + new_bid + "</li>");
						// $("#bids").append("<li>" + selected_bid_level.text() + "" + selected_bid_suit.text() + "</li>");

						if(selected_bid_level != null) {
							selected_bid_level.removeClass("active");
						}
						if(selected_bid_suit != null) {
							selected_bid_suit.removeClass("active");
						}
						if(selected_bid_alternative != null) {
							selected_bid_alternative.removeClass("active");
						}
						selected_bid_level = null;
						selected_bid_suit = null;
						selected_bid_alternative = null;
					}
					if(selected_bid_alternative != null){
						$("#bids").append("<li bid='" + selected_bid_alternative.text() + "'><span class='lead'>" + selected_bid_alternative.text()	 + "</span></li>");
						
						if(selected_bid_level != null) {
							selected_bid_level.removeClass("active");
						}
						if(selected_bid_suit != null) {
							selected_bid_suit.removeClass("active");
						}
						if(selected_bid_alternative != null) {
							selected_bid_alternative.removeClass("active");
						}
						selected_bid_level = null;
						selected_bid_suit = null;
						selected_bid_alternative = null;
					}
				}

				$("#undo-bid").click(function() {
					$('#bids li:last').remove();
					return false;
				});


				var selected_card_level = null;
				var selected_card_suit = null;


				$(".card-level").click(function() {
					if(selected_card_level != null) {
						selected_card_level.removeClass("active");
					}
					selected_card_level = $(this);
					selected_card_level.addClass("active");
					addCard();
				});

				$(".card-suit").click(function() {
					if(selected_card_suit != null) {
						selected_card_suit.removeClass("active");
					}
					selected_card_suit = $(this);
					selected_card_suit.addClass("active");
					addCard();
				});
				

				function addCard() {
					if(selected_card_level != null && selected_card_suit != null) {


						new_card = "<span class='card " + club_map[selected_card_suit.text().trim()] +"  lead'><span class='rank'>" + selected_card_level.text() + "</span> <span class='suit'></span></span>";

						$("#cards").append("<li card='" + selected_card_level.text() + selected_card_suit.text().trim() + "' >" + new_card + "</li>");

						// $("#cards").append("<li>" + selected_card_level.text() + "" + selected_card_suit.text() + "</li>");

						if(selected_card_level != null) {
							selected_card_level.removeClass("active");
						}
						if(selected_card_suit != null) {
							selected_card_suit.removeClass("active");
						}

						selected_card_level = null;
						selected_card_suit = null;
					}
				}

				$("#undo-card").click(function() {
					$('#cards li:last').remove();
					return false;
				});


				$("#board-complete").click(function() {

					if($("#player-name").val() != "") {
	  					var firebase = new Firebase('https://bridge-recorder.firebaseio.com/players/' + $("#player-name").val() + "/boards");


	  					var allBids = [];
						$("#bids li").each(function() { allBids.push($(this).attr('bid')) });

	  					var allCards = [];
						$("#cards li").each(function() { allCards.push($(this).attr('card'	)) });

						results = {
							table: $("#table-number").val(),
							board: $("#board-number").val(),
							position: table_position.text(),
							bidding: allBids,
							cards: allCards
						}

						firebase.push(results);

						selected_bid_level = null;
						selected_bid_suit = null;
						selected_bid_alternative = null;
						selected_card_level = null;
						selected_card_suit = null;

						$("#cards").empty();
						$("#bids").empty();

						$("#board-number").val("");
					}
				});
				
			});

		</script>
	</head>

	<body>
		<div class="container">
			<div class="page-header">
			  <h1>Bridge
				<span class='card clubs'>
	              <span class='suit'></span>
	            </span>
				<span class='card spades'>
	              <span class='suit'></span>
	            </span>
				<span class='card hearts'>
	              <span class='suit'></span>
	            </span>
				<span class='card diams'>
	              <span class='suit'></span>
	            </span>

			  </h1>
			</div> 
			<p class="lead">Enter in your name, table, position and board. For the bidding and card playing, press the combination of buttons which represent the level and suit. All actions can be undone if mistakes are made. Once finished with the board press "Board Complete" and start again for the next board.
			</p>
			<div class="page-header">
			  <h3>Player Info</h3>
			</div>

			<input type="text" class="form-control input-lg" id="player-name" placeholder="Name">
			<br />
  			<input type="text" class="form-control input-lg" id="table-number" placeholder="Table Number">
  			<br />
			<div class="btn-group">
			  <button type="button" class="btn btn-default btn-lg table-position">N</button>
			  <button type="button" class="btn btn-default btn-lg table-position">E</button>
			  <button type="button" class="btn btn-default btn-lg table-position">S</button>
			  <button type="button" class="btn btn-default btn-lg table-position">W</button>
			</div>
			

			<div class="page-header">
			  <h3>Board Info</h3>
			</div>

			<input type="text" class="form-control input-lg" id="board-number" placeholder="Board Number">


			<div class="page-header">
			  <h3>Bidding</h3>
			</div>


			<div class="btn-group">
			  <button type="button" class="btn btn-default btn-lg bid-level">1</button>
			  <button type="button" class="btn btn-default btn-lg bid-level">2</button>
			  <button type="button" class="btn btn-default btn-lg bid-level">3</button>
			  <button type="button" class="btn btn-default btn-lg bid-level">4</button>
			  <button type="button" class="btn btn-default btn-lg bid-level">5</button>
			  <button type="button" class="btn btn-default btn-lg bid-level">6</button>
			  <button type="button" class="btn btn-default btn-lg bid-level">7</button>
			</div>

			<br /> <br />

			<div class="btn-group">
				<span class='card clubs'>
					<button type="button" class="btn btn-default btn-lg bid-suit suit">C </button>
				</span>
				<span class='card diams'>
					<button type="button" class="btn btn-default btn-lg bid-suit suit">D </button>
				</span>
				<span class='card hearts'>
					<button type="button" class="btn btn-default btn-lg bid-suit suit">H </button>
				</span>
				<span class='card spades'>
					<button type="button" class="btn btn-default btn-lg bid-suit suit">S </button>
				</span>
				<span class='card nt'>
					<button type="button" class="btn btn-default btn-lg bid-suit suit">NT</button>
				</span>
			</div>

			<br /> <br />
			<div class="btn-group">
			  <button type="button" class="btn btn-default btn-lg bit-alternative">Pass</button>
			  <button type="button" class="btn btn-default btn-lg bit-alternative">X</button>
			  <button type="button" class="btn btn-default btn-lg bit-alternative">XX</button>
			</div>

			<br /><br />
			<ul id="bids">
			</ul>

			<a href="" id="undo-bid" class="lead">(Undo bidding)</a>

			<div class="page-header">
			  <h3>Tricks</h3>
			</div>


			<div class="btn-group">
			  <button type="button" class="btn btn-default btn-lg card-level">2</button>
			  <button type="button" class="btn btn-default btn-lg card-level">3</button>
			  <button type="button" class="btn btn-default btn-lg card-level">4</button>
			  <button type="button" class="btn btn-default btn-lg card-level">5</button>
			  <button type="button" class="btn btn-default btn-lg card-level">6</button>
			  <button type="button" class="btn btn-default btn-lg card-level">7</button>
			  <button type="button" class="btn btn-default btn-lg card-level">8</button>
			  <button type="button" class="btn btn-default btn-lg card-level">9</button>
			  <button type="button" class="btn btn-default btn-lg card-level">10</button>
			  <button type="button" class="btn btn-default btn-lg card-level">J</button>
			  <button type="button" class="btn btn-default btn-lg card-level">Q</button>
			  <button type="button" class="btn btn-default btn-lg card-level">K</button>
			  <button type="button" class="btn btn-default btn-lg card-level">A</button>
			</div>
			<br /> <br />
			<div class="btn-group">
				<span class='card clubs'>
					<button type="button" class="btn btn-default btn-lg card-suit suit">C </button>
				</span>
				<span class='card diams'>
					<button type="button" class="btn btn-default btn-lg card-suit suit">D </button>
				</span>
				<span class='card hearts'>
					<button type="button" class="btn btn-default btn-lg card-suit suit">H </button>
				</span>
				<span class='card spades'>
					<button type="button" class="btn btn-default btn-lg card-suit suit">S </button>
				</span>
			</div>
			<br /> <br />

			<ul id="cards">
			</ul>

			<a href="" id="undo-card" class="lead">(Undo card)</a>

			
			<div class="page-header">
			  <h3>Finish</h3>
			</div>
			<button type="button" class="btn btn-success btn-lg" id="board-complete">Board Complete</button>
			<div class="page-header">
			  <h3 class="pull-right"><small>Made by <a href="http://www.markdessain.com">Mark Dessain</a></small></h3>
			</div>
			<br /> <br />
		</div>
	</body>



</html>